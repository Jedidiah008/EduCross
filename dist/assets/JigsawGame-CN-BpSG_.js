import{r as n,j as e,m as f,B as p,C as B,X as Q,L as q}from"./index-Dbl9gluG.js";import{u as F,G as M,a as z}from"./useGameQuestions-sVK4q6BI.js";function X({subjectId:d,unitId:m}){const{jigsaw:s}=F(d,m),[i,j]=n.useState(0),[k,x]=n.useState([]),[o,u]=n.useState([]),[c,b]=n.useState(!1),[N,y]=n.useState(0),[G,v]=n.useState(!1),[g,w]=n.useState(!1),[h,S]=n.useState(null),l=s&&s.length>i?s[i]:null,D=l?[...l].sort((r,t)=>r.order-t.order).map(r=>r.text).join("").trim():"",C=l&&l.answer?l.answer:"";n.useEffect(()=>{if(g&&l){const r=l.map(t=>({id:t.id,text:t.text,order:t.order}));x([...r].sort(()=>Math.random()-.5)),u(new Array(l.length).fill(null)),b(!1)}},[i,g,l]);const L=r=>{S(r)},R=r=>{h&&(x(t=>t.filter(a=>a.id!==h.id)),o[r]&&x(t=>[...t,o[r]]),u(t=>{const a=[...t];return a[r]=h,a}),S(null))},A=r=>{const t=o[r];t&&(u(a=>{const P=[...a];return P[r]=null,P}),x(a=>[...a,t]))},J=()=>{o.length>0&&o.every((t,a)=>t!==null&&Number(t.order)===a+1)&&y(t=>t+1),b(!0)},E=()=>{i+1>=(s?s.length:0)?v(!0):j(r=>r+1)},H=o.length>0&&o.every(r=>r!==null);return G?e.jsx(M,{score:N,maxScore:s?s.length:0,gameName:"Jigsaw Puzzle",subjectId:d,unitId:m,onRetry:()=>{j(0),y(0),v(!1),w(!1)}}):g?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(z,{title:"Jigsaw Puzzle",subjectId:d,unitId:m,score:N,maxScore:s?s.length:0}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 gap-8",children:[e.jsxs("div",{className:"text-center max-w-2xl",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Level ",i+1,"/",s?s.length:0]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Arrange words to form the phrase for:"}),C?e.jsx("p",{className:"text-xl font-medium text-primary bg-primary/10 px-4 py-2 rounded-lg inline-block",children:C}):null]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center p-4 bg-card rounded-xl border-2 border-border min-h-[80px]",children:o.map((r,t)=>e.jsx("div",{onDragOver:a=>a.preventDefault(),onDrop:()=>R(t),onClick:()=>!c&&A(t),className:`min-w-[80px] h-12 flex items-center justify-center rounded-lg border-2 border-dashed transition-colors cursor-pointer
                ${r?c?Number(r.order)===t+1?"border-green-500 bg-green-500/20":"border-game-red bg-game-red/20":"border-primary bg-primary/20":"border-muted-foreground/30 hover:border-primary"}`,children:r?e.jsxs("span",{className:"font-medium px-3 flex items-center gap-2",children:[r.text,c&&(Number(r.order)===t+1?e.jsx(B,{className:"text-green-500",size:16}):e.jsx(Q,{className:"text-game-red",size:16}))]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:t+1})},t))}),!c&&e.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:k.map(r=>e.jsx(f.div,{draggable:!0,onDragStart:()=>L(r),className:"px-4 py-2 bg-game-yellow text-game-navy font-bold rounded-lg cursor-grab active:cursor-grabbing shadow-md",whileHover:{scale:1.05},whileTap:{scale:.95},children:r.text},r.id))}),c&&e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center bg-card p-4 rounded-xl border-2 border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-center mb-2",children:[e.jsx(q,{className:"text-game-yellow",size:20}),e.jsx("span",{className:"font-bold",children:"Correct Phrase:"})]}),e.jsx("p",{className:"text-lg text-primary",children:D})]}),e.jsxs("div",{className:"flex gap-4",children:[!c&&H&&e.jsx(p,{size:"lg",onClick:J,children:"Check Answer"}),c&&e.jsx(p,{size:"lg",onClick:E,children:i+1>=(s?s.length:0)?"Finish":"Next Level"})]})]})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(z,{title:"Jigsaw Puzzle",subjectId:d,unitId:m}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ§©"}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Read the answer/definition shown, then arrange the word pieces in the correct order to form the question/phrase that corresponds to it."}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:[s?s.length:0," levels to complete"]}),e.jsx(p,{size:"lg",onClick:()=>w(!0),children:"Start Game"})]})})]})}export{X as default};
