import{r as i,j as t,m as b,B as j,C as A,X as H}from"./index-Dbl9gluG.js";import{u as O,G as P,a as S}from"./useGameQuestions-sVK4q6BI.js";function B({subjectId:c,unitId:d}){const{dragdrop:l}=O(c,d),[m,h]=i.useState([]),[N,w]=i.useState([]),[y,f]=i.useState({}),[g,v]=i.useState(null),[k,u]=i.useState(!1),[n,C]=i.useState(!1),[p,D]=i.useState(!1);i.useEffect(()=>{if(p&&l&&l.categories&&l.categories.length>0){const e=l;w(e.categories),h(e.items.map((s,o)=>({id:`item-${o}`,text:s.text,category:s.category})).sort(()=>Math.random()-.5));const r={};e.categories.forEach(s=>{r[s]=[]}),f(r)}},[p,l]);const G=e=>{v(e)},E=e=>{g&&(h(r=>r.filter(s=>s.id!==g.id)),f(r=>{const s={...r};return Object.keys(s).forEach(o=>{s[o]=s[o].filter(a=>a.id!==g.id)}),s[e]=[...s[e],g],s}),v(null))},R=(e,r)=>{f(s=>({...s,[r]:s[r].filter(o=>o.id!==e.id)})),h(s=>[...s,e])},z=()=>{C(!0),m.length===0&&setTimeout(()=>u(!0),2e3)},$=()=>{let e=0,r=0;return Object.entries(y).forEach(([s,o])=>{o.forEach(a=>{r++,a.category===s&&e++})}),{correct:e,total:r}},x=(e,r)=>e.category===r;if(k){const{correct:e,total:r}=$();return t.jsx(P,{score:e,maxScore:r,gameName:"Drag and Drop",subjectId:c,unitId:d,onRetry:()=>{u(!1),C(!1),D(!1)}})}return!p||!l||!l.categories||l.categories.length===0?t.jsxs("div",{className:"min-h-screen flex flex-col",children:[t.jsx(S,{title:"Drag and Drop",subjectId:c,unitId:d}),t.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:t.jsxs(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[t.jsx("div",{className:"text-6xl mb-4",children:"ðŸŽ¯"}),t.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:"Drag items from the left side into the correct category boxes on the right. Categories turn red if they contain wrong answers."}),!l||l.categories.length===0?t.jsx("p",{className:"text-game-red",children:"No category questions available for this unit."}):t.jsx(j,{size:"lg",onClick:()=>D(!0),children:"Start Game"})]})})]}):t.jsxs("div",{className:"min-h-screen flex flex-col",children:[t.jsx(S,{title:"Drag and Drop",subjectId:c,unitId:d}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row p-4 gap-6",children:[t.jsxs("div",{className:"lg:w-1/3 bg-card p-4 rounded-xl border-2 border-border",children:[t.jsx("h3",{className:"font-display text-lg font-bold mb-4",children:"Items to Sort"}),t.jsxs("div",{className:"space-y-2",children:[m.map(e=>t.jsx(b.div,{draggable:!0,onDragStart:()=>G(e),className:"p-3 bg-primary/20 border-2 border-primary rounded-lg cursor-grab active:cursor-grabbing font-medium",whileHover:{scale:1.02},whileTap:{scale:.98},children:e.text},e.id)),m.length===0&&!n&&t.jsx("p",{className:"text-muted-foreground text-center py-4",children:"All items placed!"})]})]}),t.jsx("div",{className:"lg:w-2/3 grid gap-4",style:{gridTemplateColumns:`repeat(${Math.min(N.length,3)}, 1fr)`},children:N.map(e=>{const r=y[e]||[],s=n&&r.some(a=>!x(a,e)),o=n&&r.length>0&&r.every(a=>x(a,e));return t.jsxs("div",{onDragOver:a=>a.preventDefault(),onDrop:()=>E(e),className:`p-4 rounded-xl border-2 min-h-[200px] transition-colors
                  ${s?"border-game-red bg-game-red/10":o?"border-green-500 bg-green-500/10":"border-border bg-card"}`,children:[t.jsx("h4",{className:"font-display text-lg font-bold mb-4 text-center",children:e}),t.jsx("div",{className:"space-y-2",children:r.map(a=>t.jsxs(b.div,{className:`p-3 rounded-lg font-medium flex items-center justify-between
                        ${n?x(a,e)?"bg-green-500/20 border-2 border-green-500":"bg-game-red/20 border-2 border-game-red":"bg-muted"}`,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},children:[t.jsx("span",{children:a.text}),n&&(x(a,e)?t.jsx(A,{className:"text-green-500",size:18}):t.jsx(H,{className:"text-game-red",size:18})),!n&&t.jsx("button",{onClick:()=>R(a,e),className:"text-muted-foreground hover:text-foreground",children:"Ã—"})]},a.id))})]},e)})})]}),!n&&m.length===0&&t.jsx("div",{className:"p-4 flex justify-center",children:t.jsx(j,{size:"lg",onClick:z,children:"Check Answers"})}),n&&t.jsx("div",{className:"p-4 flex justify-center",children:t.jsx(j,{size:"lg",onClick:()=>u(!0),children:"Continue"})})]})}export{B as default};
