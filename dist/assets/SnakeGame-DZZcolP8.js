import{c as N,r as o,j as e,m as P,B as h,A as Q}from"./index-Dbl9gluG.js";import{u as ee,G as te,a as V}from"./useGameQuestions-sVK4q6BI.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=N("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=N("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=N("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=N("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=N("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),i=15,d=28;function de({subjectId:k,unitId:b}){const{snake:f}=ee(k,b),[y,q]=o.useState(0),[W,C]=o.useState([{x:7,y:7}]),[B,S]=o.useState({x:1,y:0}),[M,A]=o.useState([]),[z,G]=o.useState(""),[p,j]=o.useState(!1),[R,F]=o.useState(!1),[_,H]=o.useState(0),[u,E]=o.useState(!1),[$,O]=o.useState(!1),[x,T]=o.useState(200),U=o.useRef(void 0),l=o.useRef(B),m=f[y],w=((m==null?void 0:m.answer)||"").toUpperCase(),I=a=>{const s=(a||w||"").toUpperCase();if(!s)return;const t=[],r=new Set;r.add("7,7");for(const c of s.split("")){let n;do n={x:Math.floor(Math.random()*i),y:Math.floor(Math.random()*i)};while(r.has(`${n.x},${n.y}`));r.add(`${n.x},${n.y}`),t.push({pos:n,char:c})}const g="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let c=0;c<8;c++){let n;do n={x:Math.floor(Math.random()*i),y:Math.floor(Math.random()*i)};while(r.has(`${n.x},${n.y}`));r.add(`${n.x},${n.y}`),t.push({pos:n,char:g[Math.floor(Math.random()*g.length)]})}A(t)},Z=o.useCallback(()=>{C([{x:7,y:7}]),S({x:1,y:0}),l.current={x:1,y:0},G(""),j(!1),A([])},[]),D=a=>{var r;const s=Math.max(0,Math.min(a,f.length-1));q(s),C([{x:7,y:7}]),S({x:1,y:0}),l.current={x:1,y:0},G(""),j(!1),E(!1),O(!0);const t=(((r=f[s])==null?void 0:r.answer)||"").toUpperCase();I(t)};o.useEffect(()=>{const a=s=>{if(!u||p)return;const t={...l.current};switch(s.key){case"ArrowUp":case"w":case"W":l.current.y!==1&&(t.x=0,t.y=-1);break;case"ArrowDown":case"s":case"S":l.current.y!==-1&&(t.x=0,t.y=1);break;case"ArrowLeft":case"a":case"A":l.current.x!==1&&(t.x=-1,t.y=0);break;case"ArrowRight":case"d":case"D":l.current.x!==-1&&(t.x=1,t.y=0);break}l.current=t,S(t)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[u,p]),o.useEffect(()=>{if(!u||p||R)return;const a=()=>{C(s=>{const t=s[0],r={x:t.x+l.current.x,y:t.y+l.current.y};if(r.x<0||r.x>=i||r.y<0||r.y>=i||s.some(c=>c.x===r.x&&c.y===r.y))return j(!0),s;const g=M.findIndex(c=>c.pos.x===r.x&&c.pos.y===r.y);if(g!==-1){const c=M[g],n=z+c.char;return G(n),A(v=>v.filter((oe,Y)=>Y!==g)),w.startsWith(n)?(n===w&&(H(v=>v+1),y+1>=f.length?F(!0):setTimeout(()=>{const v=y+1;D(v)},500)),[r,...s]):(j(!0),s)}return[r,...s.slice(0,-1)]})};return U.current=window.setInterval(a,x),()=>{U.current&&clearInterval(U.current)}},[u,p,R,M,z,w,y,f.length,Z,x]);const K=()=>T(a=>Math.max(50,a-25)),J=()=>T(a=>Math.min(400,a+25)),X=()=>x<=100?"Very Fast":x<=150?"Fast":x<=200?"Normal":x<=300?"Slow":"Very Slow",L=(a,s)=>{if(!u||p)return;const t={...l.current};a===0&&s===-1&&l.current.y!==1?(t.x=0,t.y=-1):a===0&&s===1&&l.current.y!==-1?(t.x=0,t.y=1):a===-1&&s===0&&l.current.x!==1?(t.x=-1,t.y=0):a===1&&s===0&&l.current.x!==-1&&(t.x=1,t.y=0),l.current=t,S(t)};return R?e.jsx(te,{score:_,maxScore:f.length,gameName:"Snake Game",subjectId:k,unitId:b,onRetry:()=>{q(0),H(0),F(!1),E(!1)}}):!u&&!$?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(V,{title:"Snake Game",subjectId:k,unitId:b}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ"}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Read the instructions, then click Start Level to preview the board and question. Use arrow keys to control the snake. Eat letters in order to spell the answer. Don't hit the walls or eat wrong letters!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:[f.length," levels to complete"]}),e.jsx(h,{size:"lg",onClick:()=>{D(0)},children:"Start Level"})]})})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(V,{title:"Snake Game",subjectId:k,unitId:b,score:_,maxScore:f.length}),e.jsxs("div",{className:"flex-1 flex items-center justify-center p-4 gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Level ",y+1]}),$?e.jsxs("p",{className:"text-lg font-medium",children:["(Preview) ",m==null?void 0:m.question]}):e.jsx("p",{className:"text-lg font-medium",children:m==null?void 0:m.question}),e.jsx("p",{className:"font-mono text-2xl text-primary mt-2 tracking-widest",children:z.padEnd(w.length,"_").split("").join(" ")})]}),e.jsxs("div",{className:"relative bg-card border-2 border-border rounded-lg overflow-hidden",style:{width:i*d,height:i*d},children:[e.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${i}, 1fr)`},children:Array.from({length:i*i}).map((a,s)=>e.jsx("div",{className:"border border-border/20"},s))}),M.map((a,s)=>e.jsx("div",{className:"absolute flex items-center justify-center font-bold text-lg bg-game-yellow text-game-navy rounded",style:{left:a.pos.x*d,top:a.pos.y*d,width:d,height:d},children:a.char},s)),W.map((a,s)=>e.jsx(P.div,{className:`absolute rounded ${s===0?"bg-green-600":"bg-green-500/70"}`,style:{left:a.x*d+2,top:a.y*d+2,width:d-4,height:d-4},initial:!1,animate:{scale:s===0?1:.9}},s))]}),p&&e.jsxs(P.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center",children:[e.jsx("p",{className:"text-game-red font-bold text-xl mb-4",children:"Game Over!"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["Correct answer: ",w]}),e.jsx(h,{onClick:()=>{D(y)},children:"Try Again"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use arrow keys â† â†‘ â†’ â†“ to move"}),e.jsxs("div",{className:"mt-4 flex flex-col items-center gap-2",children:[e.jsx(h,{variant:"outline",size:"icon",onClick:()=>L(0,-1),className:"w-10 h-10",children:e.jsx(re,{size:20})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"outline",size:"icon",onClick:()=>L(-1,0),className:"w-10 h-10",children:e.jsx(Q,{size:20})}),e.jsx(h,{variant:"outline",size:"icon",onClick:()=>L(0,1),className:"w-10 h-10",children:e.jsx(se,{size:20})}),e.jsx(h,{variant:"outline",size:"icon",onClick:()=>L(1,0),className:"w-10 h-10",children:e.jsx(ae,{size:20})})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[$&&!u&&e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(h,{size:"lg",onClick:()=>{E(!0),O(!1)},children:"Start"})}),e.jsxs("div",{className:"bg-card border-2 border-border rounded-xl p-4 min-w-[160px]",children:[e.jsx("h3",{className:"font-display font-bold text-center mb-4",children:"Speed Settings"}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(h,{variant:"outline",size:"icon",onClick:K,disabled:x<=50,className:"w-10 h-10",children:e.jsx(le,{size:20})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-lg",children:X()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[x,"ms"]})]}),e.jsx(h,{variant:"outline",size:"icon",onClick:J,disabled:x>=400,className:"w-10 h-10",children:e.jsx(ne,{size:20})})]})]})]})]})]})}export{de as default};
