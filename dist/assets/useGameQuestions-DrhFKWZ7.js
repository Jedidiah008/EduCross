import{c as g,u as p,j as e,B as x,A as j,b as v,r as f,m as h,T as w,s as N,g as k}from"./index-DXGNgIhw.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=g("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=g("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);function q({title:i,subjectId:o,unitId:a,score:l,maxScore:c,timeLeft:d}){const r=p(),t=s=>{const n=Math.floor(s/60),m=s%60;return`${n}:${m.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-card/50 backdrop-blur-sm border-b border-border",children:[e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>r(`/subject/${o}/unit/${a}/games`),className:"gap-2",children:[e.jsx(j,{size:18}),"Back"]}),e.jsx("h1",{className:"font-display text-xl font-bold text-foreground",children:i}),e.jsxs("div",{className:"flex items-center gap-4",children:[d!==void 0&&e.jsx("div",{className:`font-mono text-lg font-bold ${d<=10?"text-game-red animate-pulse":"text-game-yellow"}`,children:t(d)}),l!==void 0&&c!==void 0&&e.jsxs("div",{className:"font-display text-lg",children:[e.jsx("span",{className:"text-primary",children:l}),e.jsxs("span",{className:"text-muted-foreground",children:["/",c]})]})]})]})}function z({score:i,maxScore:o,gameName:a,subjectId:l,unitId:c,onRetry:d}){const r=p(),{user:t,profile:s}=v(),[n,m]=f.useState(!1),u=Math.round(i/o*100);f.useEffect(()=>{(async()=>{if(t&&s&&!n)try{await N.from("game_scores").insert([{user_id:t.id,subject:l,topic:c,game_type:a,score:i,max_score:o}]),m(!0)}catch(b){console.error("Failed to save score:",b)}})()},[t,s,i,o,a,l,c,n]);const y=()=>u===100?"Perfect Score! ðŸŽ‰":u>=80?"Excellent Work! ðŸŒŸ":u>=60?"Good Job! ðŸ‘":u>=40?"Keep Practicing! ðŸ’ª":"Try Again! ðŸ“š";return e.jsx(h.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs(h.div,{initial:{y:50},animate:{y:0},className:"bg-card p-8 rounded-3xl border-2 border-primary shadow-game max-w-md w-full mx-4 text-center",children:[e.jsx(h.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"w-24 h-24 mx-auto mb-6 rounded-full bg-gradient-to-br from-game-yellow to-game-orange flex items-center justify-center",children:e.jsx(w,{size:48,className:"text-white"})}),e.jsx("h2",{className:"font-display text-3xl font-bold text-foreground mb-2",children:y()}),e.jsxs("div",{className:"my-6",children:[e.jsxs("div",{className:"text-6xl font-display font-bold text-primary mb-2",children:[i,"/",o]}),e.jsxs("div",{className:"text-xl text-muted-foreground",children:[u,"% Correct"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-4 mb-8 overflow-hidden",children:e.jsx(h.div,{initial:{width:0},animate:{width:`${u}%`},transition:{delay:.5,duration:1},className:"h-full bg-gradient-to-r from-primary to-accent rounded-full"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(x,{onClick:d,variant:"outline",className:"flex-1 gap-2",children:[e.jsx(T,{size:18}),"Retry"]}),e.jsxs(x,{onClick:()=>r("/dashboard"),className:"flex-1 gap-2",children:[e.jsx($,{size:18}),"Dashboard"]})]})]})})}function A(i,o){const a=k(i,o),l=f.useMemo(()=>{if(!a)return[];const r=[];return a.slides.forEach(t=>{t.keyTerms&&t.keyTerms.forEach(s=>{r.push({question:s.definition,answer:s.term,hints:[`First letter: ${s.term[0]}`,`${s.term.length} letters`,`Contains: ${s.term[Math.floor(s.term.length/2)]}`]})})}),a.slides.forEach(t=>{const s=Array.isArray(t.content)?t.content.join(" "):t.content;if(s.length>50){const n=t.title.split(" ").filter(m=>m.length>3);n.length>0&&r.push({question:`Topic: ${s.substring(0,100)}...`,answer:n[0],hints:[`Related to: ${t.title}`,`First letter: ${n[0][0]}`]})}}),r.slice(0,10)},[a]),c=f.useMemo(()=>{if(!a)return[];const r=[];return a.slides.forEach(t=>{t.keyTerms&&t.keyTerms.length>=3&&r.push({question:`Name the key terms related to: ${t.title}`,answers:t.keyTerms.slice(0,5).map(s=>s.term)})}),r.slice(0,5)},[a]),d=f.useMemo(()=>{if(!a)return[];const r=a.slides.slice(0,3).map(s=>s.title.split(" ").slice(0,2).join(" ")),t=[];return a.slides.slice(0,3).forEach((s,n)=>{s.keyTerms&&s.keyTerms.slice(0,3).forEach(m=>{t.push({text:m.term,category:r[n]})})}),t.length>=6?[{categories:r,items:t}]:[]},[a]);return{questions:l,enumerationQuestions:c,categoryQuestions:d,unit:a}}export{z as G,q as a,A as u};
