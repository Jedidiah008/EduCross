import{r as d,j as l,m as z,B as Q}from"./index-DXGNgIhw.js";import{u as T,G as Z,a as A}from"./useGameQuestions-DrhFKWZ7.js";const a=12;function K({subjectId:u,unitId:x}){const{questions:N}=T(u,x),[f,v]=d.useState([]),[y,b]=d.useState([]),[h,C]=d.useState([]),[B,G]=d.useState(!1),[w,W]=d.useState(null),[H,E]=d.useState(!1),[j,k]=d.useState(!1),c=d.useMemo(()=>N.slice(0,5).map(e=>e.answer.toUpperCase().replace(/\s/g,"")),[N]),F=d.useCallback(()=>{const e=Array(a).fill(null).map(()=>Array(a).fill("")),s=[{dx:1,dy:0},{dx:0,dy:1},{dx:1,dy:1},{dx:-1,dy:1}];c.forEach(t=>{let n=!1,m=0;for(;!n&&m<100;){const i=s[Math.floor(Math.random()*s.length)],S=Math.floor(Math.random()*a),M=Math.floor(Math.random()*a),$=S+i.dx*(t.length-1),D=M+i.dy*(t.length-1);if($>=0&&$<a&&D>=0&&D<a){let U=!0;for(let r=0;r<t.length;r++){const g=S+i.dx*r,p=M+i.dy*r;if(e[p][g]!==""&&e[p][g]!==t[r]){U=!1;break}}if(U){for(let r=0;r<t.length;r++){const g=S+i.dx*r,p=M+i.dy*r;e[p][g]=t[r]}n=!0}}m++}});const o="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<a;t++)for(let n=0;n<a;n++)if(e[t][n]===""){const m=(t*a+n)*7+13;e[t][n]=o[m%o.length]}return e},[c]);d.useEffect(()=>{j&&c.length>0&&f.length===0&&v(F())},[j,c.length,f.length,F]);const L=(e,s)=>{const o=[],t=Math.sign(s.col-e.col),n=Math.sign(s.row-e.row);if(t!==0&&n!==0&&Math.abs(s.col-e.col)!==Math.abs(s.row-e.row))return[e];let m=e.col,i=e.row;for(;o.push({row:i,col:m}),!(m===s.col&&i===s.row||(m+=t,i+=n,o.length>a)););return o},P=(e,s)=>{G(!0),W({row:e,col:s}),b([{row:e,col:s}])},X=(e,s)=>{if(B&&w){const o=L(w,{row:e,col:s});b(o)}},R=()=>{if(y.length>0&&f.length>0){const e=y.map(t=>{var n;return((n=f[t.row])==null?void 0:n[t.col])||""}).join(""),s=[...e].reverse().join(""),o=c.find(t=>(t===e||t===s)&&!h.includes(t));if(o){const t=[...h,o];C(t),t.length===c.length&&E(!0)}}G(!1),W(null),b([])},Y=(e,s)=>y.some(o=>o.row===e&&o.col===s);return H?l.jsx(Z,{score:h.length,maxScore:c.length,gameName:"Word Search",subjectId:u,unitId:x,onRetry:()=>{C([]),E(!1),k(!1),v([])}}):j?l.jsxs("div",{className:"min-h-screen flex flex-col",children:[l.jsx(A,{title:"Word Search",subjectId:u,unitId:x,score:h.length,maxScore:c.length}),l.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row items-center justify-center p-4 gap-8",children:[l.jsx("div",{className:"grid gap-1 bg-card p-4 rounded-xl border-2 border-border select-none",style:{gridTemplateColumns:`repeat(${a}, 1fr)`},onMouseLeave:R,children:f.map((e,s)=>e.map((o,t)=>l.jsx("div",{className:`w-8 h-8 flex items-center justify-center font-bold text-lg rounded cursor-pointer transition-colors
                  ${Y(s,t)?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,onMouseDown:()=>P(s,t),onMouseEnter:()=>X(s,t),onMouseUp:R,children:o},`${s}-${t}`)))}),l.jsxs("div",{className:"bg-card p-6 rounded-xl border-2 border-border min-w-[200px]",children:[l.jsx("h3",{className:"font-display text-lg font-bold mb-4",children:"Find these words:"}),l.jsx("div",{className:"space-y-2",children:c.map((e,s)=>l.jsxs("div",{className:`font-mono text-lg ${h.includes(e)?"line-through text-muted-foreground":"text-foreground"}`,children:[h.includes(e)?"âœ“ ":"â—‹ ",e]},s))})]})]})]}):l.jsxs("div",{className:"min-h-screen flex flex-col",children:[l.jsx(A,{title:"Word Search",subjectId:u,unitId:x}),l.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:l.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[l.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”"}),l.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),l.jsx("p",{className:"text-muted-foreground mb-6",children:"Find hidden words in the grid. Click and drag to select letters in a line (horizontal, vertical, or diagonal)."}),l.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:[c.length," words to find"]}),l.jsx(Q,{size:"lg",onClick:()=>k(!0),children:"Start Game"})]})})]})}export{K as default};
