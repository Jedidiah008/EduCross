import{r as l,j as e,m as p,B as j,C as E,X as H,L as T}from"./index-DXGNgIhw.js";import{u as B,G as $,a as z}from"./useGameQuestions-DrhFKWZ7.js";function O({subjectId:m,unitId:x}){const{questions:n}=B(m,x),[d,b]=l.useState(0),[k,g]=l.useState([]),[i,h]=l.useState([]),[o,y]=l.useState(!1),[v,N]=l.useState(0),[G,w]=l.useState(!1),[f,S]=l.useState(!1),[u,C]=l.useState(null),a=n[d];l.useEffect(()=>{if(f&&a){const t=a.question.split(" ").filter(c=>c.length>0),r=t.map((c,P)=>({id:`piece-${P}`,text:c,order:P}));g([...r].sort(()=>Math.random()-.5)),h(new Array(t.length).fill(null)),y(!1)}},[d,f,a]);const D=s=>{C(s)},L=s=>{u&&(g(t=>t.filter(r=>r.id!==u.id)),i[s]&&g(t=>[...t,i[s]]),h(t=>{const r=[...t];return r[s]=u,r}),C(null))},q=s=>{const t=i[s];t&&(h(r=>{const c=[...r];return c[s]=null,c}),g(r=>[...r,t]))},R=()=>{i.every((t,r)=>(t==null?void 0:t.order)===r)&&N(t=>t+1),y(!0)},A=()=>{d+1>=n.length?w(!0):b(s=>s+1)},J=i.every(s=>s!==null);return G?e.jsx($,{score:v,maxScore:n.length,gameName:"Jigsaw Puzzle",subjectId:m,unitId:x,onRetry:()=>{b(0),N(0),w(!1),S(!1)}}):f?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(z,{title:"Jigsaw Puzzle",subjectId:m,unitId:x,score:v,maxScore:n.length}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 gap-8",children:[e.jsxs("div",{className:"text-center max-w-2xl",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Level ",d+1,"/",n.length]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Arrange words to form the phrase for:"}),e.jsx("p",{className:"text-xl font-medium text-primary bg-primary/10 px-4 py-2 rounded-lg inline-block",children:a==null?void 0:a.answer})]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center p-4 bg-card rounded-xl border-2 border-border min-h-[80px]",children:i.map((s,t)=>e.jsx("div",{onDragOver:r=>r.preventDefault(),onDrop:()=>L(t),onClick:()=>!o&&q(t),className:`min-w-[80px] h-12 flex items-center justify-center rounded-lg border-2 border-dashed transition-colors cursor-pointer
                ${s?o?s.order===t?"border-green-500 bg-green-500/20":"border-game-red bg-game-red/20":"border-primary bg-primary/20":"border-muted-foreground/30 hover:border-primary"}`,children:s?e.jsxs("span",{className:"font-medium px-3 flex items-center gap-2",children:[s.text,o&&(s.order===t?e.jsx(E,{className:"text-green-500",size:16}):e.jsx(H,{className:"text-game-red",size:16}))]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:t+1})},t))}),!o&&e.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:k.map(s=>e.jsx(p.div,{draggable:!0,onDragStart:()=>D(s),className:"px-4 py-2 bg-game-yellow text-game-navy font-bold rounded-lg cursor-grab active:cursor-grabbing shadow-md",whileHover:{scale:1.05},whileTap:{scale:.95},children:s.text},s.id))}),o&&e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center bg-card p-4 rounded-xl border-2 border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-center mb-2",children:[e.jsx(T,{className:"text-game-yellow",size:20}),e.jsx("span",{className:"font-bold",children:"Correct Phrase:"})]}),e.jsx("p",{className:"text-lg text-primary",children:a==null?void 0:a.question})]}),e.jsxs("div",{className:"flex gap-4",children:[!o&&J&&e.jsx(j,{size:"lg",onClick:R,children:"Check Answer"}),o&&e.jsx(j,{size:"lg",onClick:A,children:d+1>=n.length?"Finish":"Next Level"})]})]})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(z,{title:"Jigsaw Puzzle",subjectId:m,unitId:x}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ§©"}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Read the answer/definition shown, then arrange the word pieces in the correct order to form the question/phrase that corresponds to it."}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:[n.length," levels to complete"]}),e.jsx(j,{size:"lg",onClick:()=>S(!0),children:"Start Game"})]})})]})}export{O as default};
