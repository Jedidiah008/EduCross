import{r as a,j as e,m as j,B as P}from"./index-Dbl9gluG.js";import{u as H,G as R,a as k}from"./useGameQuestions-sVK4q6BI.js";function Q({subjectId:d,unitId:m}){const{memoryflip:u}=H(d,m),[n,h]=a.useState([]),[f,p]=a.useState([]),[v,N]=a.useState(0),[G,w]=a.useState(0),[$,M]=a.useState(!1),[x,C]=a.useState(!1),[q,g]=a.useState(!1),o=a.useMemo(()=>u?u.slice(0,6):[],[u]);a.useEffect(()=>{if(x&&o.length>0&&n.length===0){const s=[];o.forEach((l,t)=>{s.push({id:`q-${t}`,content:l.question,type:"question",pairId:t,isFlipped:!1,isMatched:!1}),s.push({id:`a-${t}`,content:l.answer,type:"answer",pairId:t,isFlipped:!1,isMatched:!1})});const r=[...s].sort(()=>Math.random()-.5);h(r),N(0),w(0),p([])}},[x,o,n.length]);const E=s=>{if(q||f.length>=2||f.includes(s))return;const r=n.find(t=>t.id===s);if(!r||r.isMatched)return;const l=[...f,s];if(p(l),l.length===2){w(i=>i+1),g(!0);const[t,F]=l,y=n.find(i=>i.id===t),b=n.find(i=>i.id===F);y&&b&&y.pairId===b.pairId&&y.type!==b.type?setTimeout(()=>{h(i=>i.map(c=>c.id===t||c.id===F?{...c,isMatched:!0}:c)),N(i=>{const c=i+1;return c===o.length&&setTimeout(()=>M(!0),500),c}),p([]),g(!1)},1e3):setTimeout(()=>{p([]),g(!1)},1500)}},S=s=>{const r=n.find(l=>l.id===s);return f.includes(s)||(r==null?void 0:r.isMatched)};return $?e.jsx(R,{score:v,maxScore:o.length,gameName:"Memory Flip",subjectId:d,unitId:m,onRetry:()=>{M(!1),C(!1),h([])}}):x?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(k,{title:"Memory Flip",subjectId:d,unitId:m,score:v,maxScore:o.length}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 gap-4",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Moves: ",G]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-4 max-w-4xl w-full px-4",children:n.map(s=>e.jsx(j.div,{className:"aspect-[3/4] cursor-pointer perspective-1000 min-h-[140px] sm:min-h-[160px]",onClick:()=>E(s.id),whileHover:{scale:S(s.id)?1:1.05},children:e.jsxs(j.div,{className:"relative w-full h-full",initial:!1,animate:{rotateY:S(s.id)?180:0},transition:{duration:.4},style:{transformStyle:"preserve-3d"},children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center rounded-xl border-2 font-bold text-3xl
                    ${s.isMatched?"border-green-500 bg-green-500/20":"border-primary bg-gradient-to-br from-primary to-accent"}`,style:{backfaceVisibility:"hidden"},children:e.jsx("span",{className:"text-primary-foreground",children:"?"})}),e.jsx("div",{className:`absolute inset-0 flex items-center justify-center p-3 rounded-xl border-2 text-center
                    ${s.type==="question"?"bg-game-lightblue/20 border-game-lightblue":"bg-game-yellow/20 border-game-yellow"}
                    ${s.isMatched?"border-green-500 bg-green-500/20":""}`,style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:e.jsx("span",{className:"font-medium text-sm sm:text-base leading-relaxed whitespace-normal break-words",children:s.content})})]})},s.id))})]})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(k,{title:"Memory Flip",subjectId:d,unitId:m}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸƒ"}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Flip cards to find matching pairs of questions and answers. Match all pairs to win!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:[o.length," pairs to match"]}),e.jsx(P,{size:"lg",onClick:()=>C(!0),children:"Start Game"})]})})]})}export{Q as default};
