import{r as o,j as e,m as j,B as y,L as Q,C as H,X as E}from"./index-DXGNgIhw.js";import{u as B,G as L,a as I}from"./useGameQuestions-DrhFKWZ7.js";function X({subjectId:u,unitId:f}){const{questions:N}=B(u,f),[i,C]=o.useState([]),[c,b]=o.useState([]),[d,v]=o.useState(null),[n,p]=o.useState(!1),[$,k]=o.useState(!1),[w,S]=o.useState(!1),G=o.useRef(null),a=o.useMemo(()=>N.slice(0,8),[N]);o.useEffect(()=>{if(w&&a.length>0&&i.length===0){const t=[...a.map((r,l)=>({text:r.answer,correctIndex:l}))].sort(()=>Math.random()-.5);C(t),b([]),p(!1)}},[w,a,i.length]);const R=s=>{if(n)return;c.find(r=>r.questionIndex===s)&&b(r=>r.filter(l=>l.questionIndex!==s)),v(s)},z=s=>{n||d===null||(b(t=>[...t.filter(l=>l.answerIndex!==s&&l.questionIndex!==d),{questionIndex:d,answerIndex:s}]),v(null))},A=()=>{p(!0)},q=()=>c.filter(s=>i[s.answerIndex].correctIndex===s.questionIndex).length,g=s=>i[s.answerIndex].correctIndex===s.questionIndex,M=c.length===a.length;return $?e.jsx(L,{score:q(),maxScore:a.length,gameName:"Match It",subjectId:u,unitId:f,onRetry:()=>{k(!1),p(!1),S(!1),C([])}}):w?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(I,{title:"Match It",subjectId:u,unitId:f,score:n?q():c.length,maxScore:a.length}),e.jsxs("div",{className:"flex-1 flex flex-col p-4 gap-4",children:[e.jsxs("div",{ref:G,className:"flex-1 flex gap-8 justify-center items-start max-w-4xl mx-auto w-full",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("h3",{className:"font-display text-lg font-bold text-center mb-4",children:"Questions"}),a.map((s,t)=>{const r=c.some(x=>x.questionIndex===t),l=c.find(x=>x.questionIndex===t),h=l&&n&&g(l),m=l&&n&&!g(l);return e.jsxs(j.div,{onClick:()=>R(t),className:`p-3 rounded-lg border-2 cursor-pointer transition-all text-sm
                    ${d===t?"border-primary bg-primary/20 ring-2 ring-primary":""}
                    ${r&&!n?"border-game-yellow bg-game-yellow/10":""}
                    ${h?"border-green-500 bg-green-500/10":""}
                    ${m?"border-game-red bg-game-red/10":""}
                    ${!r&&!d?"border-border bg-card hover:border-primary/50":""}`,whileHover:{scale:n?1:1.02},children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"flex-1",children:[s.question.substring(0,60),s.question.length>60?"...":""]}),e.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex-shrink-0
                      ${r?"bg-game-yellow border-game-yellow":"border-muted-foreground"}`})]}),n&&m&&e.jsxs("p",{className:"text-xs text-green-500 mt-1 flex items-center gap-1",children:[e.jsx(Q,{size:12})," Correct: ",a[t].answer]})]},t)})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("h3",{className:"font-display text-lg font-bold text-center mb-4",children:"Answers"}),i.map((s,t)=>{const r=c.find(x=>x.answerIndex===t),l=!!r,h=r&&n&&g(r),m=r&&n&&!g(r);return e.jsx(j.div,{onClick:()=>z(t),className:`p-3 rounded-lg border-2 cursor-pointer transition-all text-sm
                    ${l&&!n?"border-game-yellow bg-game-yellow/10":""}
                    ${h?"border-green-500 bg-green-500/10":""}
                    ${m?"border-game-red bg-game-red/10":""}
                    ${l?"":"border-border bg-card hover:border-primary/50"}`,whileHover:{scale:n?1:1.02},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex-shrink-0
                      ${l?"bg-game-yellow border-game-yellow":"border-muted-foreground"}`}),e.jsx("span",{className:"flex-1",children:s.text}),n&&(h?e.jsx(H,{className:"text-green-500",size:16}):m?e.jsx(E,{className:"text-game-red",size:16}):null)]})},t)})]})]}),e.jsxs("div",{className:"flex justify-center gap-4 py-4",children:[!n&&M&&e.jsx(y,{size:"lg",onClick:A,children:"Check Answers"}),n&&e.jsx(y,{size:"lg",onClick:()=>k(!0),children:"Continue"})]})]})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(I,{title:"Match It",subjectId:u,unitId:f}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”—"}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Connect each question on the left to its matching answer on the right. Click a question, then click its answer to make a connection."}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:[a.length," pairs to match"]}),e.jsx(y,{size:"lg",onClick:()=>S(!0),children:"Start Game"})]})})]})}export{X as default};
