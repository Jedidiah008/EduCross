import{r,j as e,m as b,B as P}from"./index-DXGNgIhw.js";import{u as H,G as R,a as G}from"./useGameQuestions-DrhFKWZ7.js";function Q({subjectId:d,unitId:m}){const{questions:j}=H(d,m),[l,u]=r.useState([]),[f,p]=r.useState([]),[v,N]=r.useState(0),[k,M]=r.useState(0),[q,w]=r.useState(!1),[h,C]=r.useState(!1),[$,x]=r.useState(!1),o=r.useMemo(()=>j.slice(0,6),[j]);r.useEffect(()=>{if(h&&o.length>0&&l.length===0){const s=[];o.forEach((t,i)=>{s.push({id:`q-${i}`,content:t.question.substring(0,50)+(t.question.length>50?"...":""),type:"question",pairId:i,isFlipped:!1,isMatched:!1}),s.push({id:`a-${i}`,content:t.answer,type:"answer",pairId:i,isFlipped:!1,isMatched:!1})});const n=[...s].sort(()=>Math.random()-.5);u(n),N(0),M(0),p([])}},[h,o,l.length]);const E=s=>{if($||f.length>=2||f.includes(s))return;const n=l.find(i=>i.id===s);if(!n||n.isMatched)return;const t=[...f,s];if(p(t),t.length===2){M(a=>a+1),x(!0);const[i,F]=t,g=l.find(a=>a.id===i),y=l.find(a=>a.id===F);g&&y&&g.pairId===y.pairId&&g.type!==y.type?setTimeout(()=>{u(a=>a.map(c=>c.id===i||c.id===F?{...c,isMatched:!0}:c)),N(a=>{const c=a+1;return c===o.length&&setTimeout(()=>w(!0),500),c}),p([]),x(!1)},1e3):setTimeout(()=>{p([]),x(!1)},1500)}},S=s=>{const n=l.find(t=>t.id===s);return f.includes(s)||(n==null?void 0:n.isMatched)};return q?e.jsx(R,{score:v,maxScore:o.length,gameName:"Memory Flip",subjectId:d,unitId:m,onRetry:()=>{w(!1),C(!1),u([])}}):h?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(G,{title:"Memory Flip",subjectId:d,unitId:m,score:v,maxScore:o.length}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 gap-4",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Moves: ",k]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-4 max-w-4xl w-full px-4",children:l.map(s=>e.jsx(b.div,{className:"aspect-[3/4] cursor-pointer perspective-1000 min-h-[140px] sm:min-h-[160px]",onClick:()=>E(s.id),whileHover:{scale:S(s.id)?1:1.05},children:e.jsxs(b.div,{className:"relative w-full h-full",initial:!1,animate:{rotateY:S(s.id)?180:0},transition:{duration:.4},style:{transformStyle:"preserve-3d"},children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center rounded-xl border-2 font-bold text-3xl
                    ${s.isMatched?"border-green-500 bg-green-500/20":"border-primary bg-gradient-to-br from-primary to-accent"}`,style:{backfaceVisibility:"hidden"},children:e.jsx("span",{className:"text-primary-foreground",children:"?"})}),e.jsx("div",{className:`absolute inset-0 flex items-center justify-center p-3 rounded-xl border-2 text-center
                    ${s.type==="question"?"bg-game-lightblue/20 border-game-lightblue":"bg-game-yellow/20 border-game-yellow"}
                    ${s.isMatched?"border-green-500 bg-green-500/20":""}`,style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:e.jsx("span",{className:"font-medium text-sm sm:text-base leading-tight",children:s.content})})]})},s.id))})]})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(G,{title:"Memory Flip",subjectId:d,unitId:m}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸƒ"}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Flip cards to find matching pairs of questions and answers. Match all pairs to win!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:[o.length," pairs to match"]}),e.jsx(P,{size:"lg",onClick:()=>C(!0),children:"Start Game"})]})})]})}export{Q as default};
