import{r as s,j as e,m as S,a as Q,B as E,C as R,I as z}from"./index-Dbl9gluG.js";import{u as O,G as P,a as T}from"./useGameQuestions-sVK4q6BI.js";const B=[{label:"60 seconds",value:60},{label:"2 minutes",value:120},{label:"3 minutes",value:180}];function I({subjectId:x,unitId:u}){const{fighttime:a}=O(x,u),[n,w]=s.useState(0),[l,g]=s.useState([]),[d,p]=s.useState(""),[j,y]=s.useState(0),[m,b]=s.useState(!1),[N,f]=s.useState(!1),v=s.useRef(null),c=a&&a.length>n?a[n]:null,o=(c==null?void 0:c.answers)||[],h=a||[];s.useEffect(()=>{if(m&&!N&&j>0){const t=setInterval(()=>{y(r=>r<=1?(f(!0),0):r-1)},1e3);return()=>clearInterval(t)}},[m,N,j]),s.useEffect(()=>{m&&v.current&&v.current.focus()},[m,l]);const A=t=>{y(t),g([]),p(""),w(0),b(!0),f(!1)},C=()=>{if(!d.trim())return;const t=d.toLowerCase().trim(),r=o.some(i=>i.toLowerCase().trim()===t),k=l.some(i=>i.toLowerCase()===t);if(r&&!k){const i=[...l,d.trim()];g(i),i.length>=o.length&&(n+1>=(a?a.length:0)?f(!0):(w(L=>L+1),g([])))}p("")},G=t=>{t.key==="Enter"&&C()},F=()=>{let t=n;return l.length===o.length&&t++,t};return N?e.jsx(P,{score:F(),maxScore:h.length,gameName:"Fight the Time",subjectId:x,unitId:u,onRetry:()=>{b(!1),f(!1)}}):!m||!a||a.length===0?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(T,{title:"Fight the Time",subjectId:x,unitId:u}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"⏱️"}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Enumerate all the answers to each question before time runs out! Type each answer and press Enter."}),h.length===0?e.jsx("p",{className:"text-game-red",children:"No fight time questions available for this unit."}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4 flex items-center justify-center gap-2",children:[e.jsx(Q,{size:16}),"Choose your time limit:"]}),e.jsx("div",{className:"flex flex-col gap-2",children:B.map(t=>e.jsx(E,{variant:"outline",size:"lg",onClick:()=>A(t.value),className:"w-full",children:t.label},t.value))})]})})]})})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(T,{title:"Fight the Time",subjectId:x,unitId:u,score:n,maxScore:h.length,timeLeft:j}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 gap-6",children:[e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Question ",n+1," of ",h.length]})}),e.jsxs(S.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full max-w-xl bg-card p-6 rounded-2xl border-2 border-border",children:[e.jsx("h3",{className:"text-xl font-bold mb-6 text-center",children:c==null?void 0:c.question}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Found: ",l.length," / ",o.length]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.map((t,r)=>e.jsxs("span",{className:"px-3 py-1 bg-green-500/20 text-green-500 rounded-full text-sm flex items-center gap-1",children:[e.jsx(R,{size:14}),t]},r)),Array.from({length:o.length-l.length}).map((t,r)=>e.jsx("span",{className:"px-3 py-1 bg-muted text-muted-foreground rounded-full text-sm",children:"???"},`empty-${r}`))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{ref:v,value:d,onChange:t=>p(t.target.value),onKeyDown:G,placeholder:"Type an answer...",className:"flex-1"}),e.jsx(E,{onClick:C,children:"Add"})]})]},n),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Press Enter to submit each answer"})]})]})}export{I as default};
