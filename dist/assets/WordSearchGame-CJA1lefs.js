import{r as f,j as r,m as Z,B as J}from"./index-Dbl9gluG.js";import{u as K,G as O,a as U}from"./useGameQuestions-sVK4q6BI.js";const d=12;function q({subjectId:S,unitId:b}){const{wordsearch:G}=K(S,b),[x,W]=f.useState([]),[v,N]=f.useState([]),[g,w]=f.useState([]),[X,Y]=f.useState(new Set),[A,E]=f.useState(!1),[$,k]=f.useState(null),[B,F]=f.useState(!1),[C,R]=f.useState(!1),m=f.useMemo(()=>(G||[]).map(e=>e.word.toUpperCase().replace(/\s/g,"")),[G]),D=f.useCallback(()=>{const e=Array(d).fill(null).map(()=>Array(d).fill("")),l=[{dx:1,dy:0},{dx:0,dy:1},{dx:1,dy:1},{dx:-1,dy:1}];m.forEach(t=>{let s=!1,i=0;for(;!s&&i<100;){const a=l[Math.floor(Math.random()*l.length)],u=Math.floor(Math.random()*d),p=Math.floor(Math.random()*d),o=u+a.dx*(t.length-1),c=p+a.dy*(t.length-1);if(o>=0&&o<d&&c>=0&&c<d){let y=!0;for(let h=0;h<t.length;h++){const j=u+a.dx*h,M=p+a.dy*h;if(e[M][j]!==""&&e[M][j]!==t[h]){y=!1;break}}if(y){for(let h=0;h<t.length;h++){const j=u+a.dx*h,M=p+a.dy*h;e[M][j]=t[h]}s=!0}}i++}});const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<d;t++)for(let s=0;s<d;s++)if(e[t][s]===""){const i=(t*d+s)*7+13;e[t][s]=n[i%n.length]}return e},[m]);f.useEffect(()=>{C&&m.length>0&&x.length===0&&W(D())},[C,m.length,x.length,D]);const H=(e,l)=>{const n=[],t=Math.sign(l.col-e.col),s=Math.sign(l.row-e.row);if(t!==0&&s!==0&&Math.abs(l.col-e.col)!==Math.abs(l.row-e.row))return[e];let i=e.col,a=e.row;for(;n.push({row:a,col:i}),!(i===l.col&&a===l.row||(i+=t,a+=s,n.length>d)););return n},L=e=>{if(x.length===0)return null;const l=[{dx:1,dy:0},{dx:0,dy:1},{dx:1,dy:1},{dx:-1,dy:1}];for(let n=0;n<d;n++)for(let t=0;t<d;t++)for(const s of l){const i=t+s.dx*(e.length-1),a=n+s.dy*(e.length-1);if(i<0||i>=d||a<0||a>=d)continue;let u=!0;for(let o=0;o<e.length;o++){const c=t+s.dx*o,y=n+s.dy*o;if(x[y][c]!==e[o]){u=!1;break}}if(u){const o=[];for(let c=0;c<e.length;c++)o.push({row:n+s.dy*c,col:t+s.dx*c});return o}let p=!0;for(let o=0;o<e.length;o++){const c=t+s.dx*o,y=n+s.dy*o;if(x[y][c]!==e[e.length-1-o]){p=!1;break}}if(p){const o=[];for(let c=0;c<e.length;c++)o.push({row:n+s.dy*c,col:t+s.dx*c});return o}}return null},z=(e,l)=>{E(!0),k({row:e,col:l}),N([{row:e,col:l}])},Q=(e,l)=>{if(A&&$){const n=H($,{row:e,col:l});N(n)}},P=()=>{if(v.length>0&&x.length>0){const e=v.map(t=>{var s;return((s=x[t.row])==null?void 0:s[t.col])||""}).join(""),l=[...e].reverse().join(""),n=m.find(t=>(t===e||t===l)&&!g.includes(t));if(n){const t=[...g,n];w(t);const s=L(n);s&&s.length>0&&Y(i=>{const a=new Set(i);return s.forEach(u=>a.add(`${u.row}-${u.col}`)),a}),t.length===m.length&&F(!0)}}E(!1),k(null),N([])},T=(e,l)=>v.some(n=>n.row===e&&n.col===l)||X.has(`${e}-${l}`);return B?r.jsx(O,{score:g.length,maxScore:m.length,gameName:"Word Search",subjectId:S,unitId:b,onRetry:()=>{w([]),F(!1),R(!1),W([])}}):C?r.jsxs("div",{className:"min-h-screen flex flex-col",children:[r.jsx(U,{title:"Word Search",subjectId:S,unitId:b,score:g.length,maxScore:m.length}),r.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row items-center justify-center p-4 gap-8",children:[r.jsx("div",{className:"grid gap-1 bg-card p-4 rounded-xl border-2 border-border select-none",style:{gridTemplateColumns:`repeat(${d}, 1fr)`},onMouseLeave:P,children:x.map((e,l)=>e.map((n,t)=>r.jsx("div",{className:`w-8 h-8 flex items-center justify-center font-bold text-lg rounded cursor-pointer transition-colors
                          ${T(l,t)?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,onMouseDown:()=>z(l,t),onMouseEnter:()=>Q(l,t),onMouseUp:P,children:n},`${l}-${t}`)))}),r.jsxs("div",{className:"bg-card p-6 rounded-xl border-2 border-border min-w-[200px]",children:[r.jsx("h3",{className:"font-display text-lg font-bold mb-4",children:"Find these words:"}),r.jsx("div",{className:"space-y-2",children:m.map((e,l)=>r.jsxs("div",{className:`font-mono text-lg ${g.includes(e)?"line-through text-muted-foreground":"text-foreground"}`,children:[g.includes(e)?"âœ“ ":"â—‹ ",e]},l))})]})]})]}):r.jsxs("div",{className:"min-h-screen flex flex-col",children:[r.jsx(U,{title:"Word Search",subjectId:S,unitId:b}),r.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:r.jsxs(Z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[r.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”"}),r.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),r.jsx("p",{className:"text-muted-foreground mb-6",children:"Find hidden words in the grid. Click and drag to select letters in a line (horizontal, vertical, or diagonal)."}),r.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:[m.length," words to find"]}),r.jsx(J,{size:"lg",onClick:()=>R(!0),children:"Start Game"})]})})]})}export{q as default};
