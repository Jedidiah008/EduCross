import{r as t,j as e,m as C,a as L,B as S,C as Q,I as R}from"./index-DXGNgIhw.js";import{u as z,G as O,a as E}from"./useGameQuestions-DrhFKWZ7.js";const P=[{label:"60 seconds",value:60},{label:"2 minutes",value:120},{label:"3 minutes",value:180}];function H({subjectId:x,unitId:u}){const{enumerationQuestions:r}=z(x,u),[l,v]=t.useState(0),[n,h]=t.useState([]),[d,g]=t.useState(""),[p,w]=t.useState(0),[m,y]=t.useState(!1),[j,f]=t.useState(!1),N=t.useRef(null),c=r[l],o=(c==null?void 0:c.answers)||[];t.useEffect(()=>{if(m&&!j&&p>0){const s=setInterval(()=>{w(a=>a<=1?(f(!0),0):a-1)},1e3);return()=>clearInterval(s)}},[m,j,p]),t.useEffect(()=>{m&&N.current&&N.current.focus()},[m,n]);const T=s=>{w(s),h([]),g(""),v(0),y(!0),f(!1)},b=()=>{if(!d.trim())return;const s=d.toLowerCase().trim(),a=o.some(i=>i.toLowerCase().trim()===s),F=n.some(i=>i.toLowerCase()===s);if(a&&!F){const i=[...n,d.trim()];h(i),i.length>=o.length&&(l+1>=r.length?f(!0):(v(k=>k+1),h([])))}g("")},A=s=>{s.key==="Enter"&&b()},G=()=>{let s=l;return n.length===o.length&&s++,s};return j?e.jsx(O,{score:G(),maxScore:r.length,gameName:"Fight the Time",subjectId:x,unitId:u,onRetry:()=>{y(!1),f(!1)}}):!m||r.length===0?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(E,{title:"Fight the Time",subjectId:x,unitId:u}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"⏱️"}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-4",children:"How to Play"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Enumerate all the answers to each question before time runs out! Type each answer and press Enter."}),r.length===0?e.jsx("p",{className:"text-game-red",children:"No enumeration questions available for this unit."}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4 flex items-center justify-center gap-2",children:[e.jsx(L,{size:16}),"Choose your time limit:"]}),e.jsx("div",{className:"flex flex-col gap-2",children:P.map(s=>e.jsx(S,{variant:"outline",size:"lg",onClick:()=>T(s.value),className:"w-full",children:s.label},s.value))})]})})]})})]}):e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(E,{title:"Fight the Time",subjectId:x,unitId:u,score:l,maxScore:r.length,timeLeft:p}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-4 gap-6",children:[e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Question ",l+1," of ",r.length]})}),e.jsxs(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full max-w-xl bg-card p-6 rounded-2xl border-2 border-border",children:[e.jsx("h3",{className:"text-xl font-bold mb-6 text-center",children:c==null?void 0:c.question}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Found: ",n.length," / ",o.length]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map((s,a)=>e.jsxs("span",{className:"px-3 py-1 bg-green-500/20 text-green-500 rounded-full text-sm flex items-center gap-1",children:[e.jsx(Q,{size:14}),s]},a)),Array.from({length:o.length-n.length}).map((s,a)=>e.jsx("span",{className:"px-3 py-1 bg-muted text-muted-foreground rounded-full text-sm",children:"???"},`empty-${a}`))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{ref:N,value:d,onChange:s=>g(s.target.value),onKeyDown:A,placeholder:"Type an answer...",className:"flex-1"}),e.jsx(S,{onClick:b,children:"Add"})]})]},l),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Press Enter to submit each answer"})]})]})}export{H as default};
